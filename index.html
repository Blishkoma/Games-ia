<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Games IA - Arcade de Jeux Vid√©o Gratuite</title>
    <meta name="description" content="D√©couvrez Games IA : 3 jeux d'arcade addictifs (Snake, Sniper, Jumper) cr√©√©s par Intelligence Artificielle. Battez les records et d√©bloquez des skins !">
    <meta name="keywords" content="Games IA, jeu gratuit, snake, sniper, jumper, arcade web, blishkoma">
    <meta name="author" content="Blishkoma">
    <link href="https://fonts.googleapis.com/css2?family=Titan+One&family=Permanent+Marker&family=Russo+One&display=swap" rel="stylesheet">
    
    <style>
        /* --- CONFIG GLOBALE --- */
        :root {
            --gd-blue: #0066ff; 
            --gd-dark: #002244;
            --gd-green: #00ff00;
            --gd-yellow: #ffcc00;
            --gd-red: #ff3333;
        }

        body {
            margin: 0; 
            font-family: 'Russo One', sans-serif;
            background-color: var(--gd-dark);
            color: white;
            overflow: hidden; 
            touch-action: none; 
            height: 100vh;
            user-select: none; 
            -webkit-user-select: none;
        }

        /* FOND ANIM√â */
        .gd-bg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: linear-gradient(to bottom, #004488, #001122);
        }
        .gd-grid-perspective {
            position: absolute; top: 0; left: 0; width: 200%; height: 200%;
            background-image: 
                linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 80px 80px;
            transform: perspective(600px) rotateX(30deg);
            animation: gridMove 10s linear infinite;
            pointer-events: none;
        }
        @keyframes gridMove { 
            0% { transform: perspective(600px) rotateX(30deg) translateY(0); } 
            100% { transform: perspective(600px) rotateX(30deg) translateY(80px); } 
        }

        .hidden { display: none !important; }
        .full-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* --- MENU PRINCIPAL --- */
        .logo-main {
            font-size: 4em; color: var(--gd-yellow);
            -webkit-text-stroke: 3px black; 
            text-shadow: 0 5px 0 #000, 0 10px 10px rgba(0,0,0,0.5);
            margin-bottom: 40px; text-align: center; letter-spacing: 2px;
            transform: skew(-5deg);
        }
        
        .menu-row { display: flex; align-items: center; gap: 20px; }

        .btn-side {
            width: 90px; height: 90px;
            background: linear-gradient(to bottom, #0099ff, #004488);
            border: 4px solid white; border-radius: 15px;
            box-shadow: 0 8px 0 #002244, 0 15px 10px rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
            font-size: 2.5em; cursor: pointer; transition: transform 0.1s;
        }
        .btn-side:active { transform: translateY(8px); box-shadow: 0 0 0 #002244; }

        .btn-play-main {
            width: 140px; height: 140px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M35,25 L80,50 L35,75 Z" fill="%23ffff00" stroke="black" stroke-width="4"/></svg>'), linear-gradient(to bottom, #00ff00, #008800);
            background-size: 60%, 100%; background-position: center, center; background-repeat: no-repeat;
            border: 5px solid white; border-radius: 20px;
            box-shadow: 0 0 20px rgba(0,255,0,0.4), 0 12px 0 #004400;
            cursor: pointer; transition: transform 0.1s;
        }
        .btn-play-main:active { transform: scale(0.95) translateY(12px); box-shadow: 0 0 5px rgba(0,255,0,0.4), 0 0 0 #004400; }

        .icon-face { width: 40px; height: 40px; background: var(--gd-yellow); border: 3px solid black; position:relative; }
        .icon-face::before { content:''; position:absolute; top:10px; left:5px; width:8px; height:8px; background:black; }
        .icon-face::after { content:''; position:absolute; top:10px; right:5px; width:8px; height:8px; background:black; }

        /* BOUTON HELP US (DONATION) */
        .btn-donate {
            position: absolute; bottom: 30px; left: 30px;
            background: linear-gradient(to bottom, #ff55aa, #aa0055);
            color: white; border: 3px solid white;
            padding: 10px 20px; border-radius: 20px;
            font-family: 'Russo One'; text-decoration: none; font-size: 1.2em;
            box-shadow: 0 5px 0 #660033; cursor: pointer;
            display: flex; align-items: center; gap: 10px; z-index: 50;
        }
        .btn-donate:active { transform: translateY(5px); box-shadow: none; }

        /* --- FEN√äTRES --- */
        .window-box {
            background: rgba(0, 20, 40, 0.95); border: 4px solid white; border-radius: 15px;
            padding: 20px; width: 90%; max-width: 500px; text-align: center;
            box-shadow: 0 0 40px rgba(0,0,0,0.8); position: relative;
            max-height: 85vh; overflow-y: auto;
        }
        .btn-back {
            position: absolute; top: 15px; left: 15px; 
            background: #ff3333; color: white; border: 3px solid white;
            padding: 5px 15px; border-radius: 8px; font-family: 'Russo One'; cursor: pointer;
            box-shadow: 0 4px 0 #880000;
        }
        .btn-back:active { transform: translateY(4px); box-shadow: none; }

        .shop-tabs { display: flex; gap: 5px; margin-bottom: 15px; margin-top: 30px; }
        .shop-tab { 
            flex: 1; padding: 10px; background: #111; color: #888; 
            border: 2px solid #555; cursor: pointer; border-radius: 8px 8px 0 0;
        }
        .shop-tab.active { background: var(--gd-blue); color: white; border-color: white; border-bottom: none; }
        
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .skin-card { 
            background: rgba(255,255,255,0.05); border: 2px solid #555; padding: 10px; 
            border-radius: 10px; transition: all 0.2s; 
        }
        .skin-card.unlocked { border-color: white; cursor: pointer; }
        .skin-card.selected { border-color: var(--gd-green); background: rgba(0,255,0,0.1); box-shadow: 0 0 10px var(--gd-green); }
        .skin-prev { width: 30px; height: 30px; margin: 0 auto 5px; border: 2px solid white; }

        /* CAROUSEL */
        .level-card {
            background: #222; border: 3px solid white; border-radius: 10px; padding: 20px;
            margin: 20px 0; height: 180px; display:flex; flex-direction:column; align-items:center; justify-content:center;
        }
        .nav-arrow { font-size: 3em; color: var(--gd-yellow); -webkit-text-stroke: 1px black; cursor: pointer; }
        .btn-launch { 
            width: 100%; padding: 15px; background: var(--gd-green); color: black; font-size: 1.5em; 
            font-family: 'Russo One'; border: 3px solid white; border-radius: 10px; cursor: pointer; 
        }

        /* --- HUD JEU --- */
        #game-hud { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        
        #btn-pause {
            position: absolute; top: 15px; left: 20px; pointer-events: auto;
            width: 40px; height: 40px; border: 3px solid white; border-radius: 8px;
            background: rgba(0,0,0,0.5); color: white; display: flex; align-items: center; justify-content: center;
            font-size: 1.2em; cursor: pointer; z-index: 50;
        }
        
        .hud-bar { 
            display: flex; justify-content: space-between; align-items:flex-start;
            padding: 10px 20px; height: 80px; margin-left: 50px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
        }
        
        .score-block { text-align: center; }
        .score-val { font-size: 2em; -webkit-text-stroke: 1.5px black; display: block; line-height: 1; text-shadow: 2px 2px 0 black; }
        .score-lbl { font-size: 0.7em; color: #ccc; }
        .score-best { color: var(--gd-yellow); }

        .prog-area {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            display: flex; align-items: center; gap: 10px; width: 40%;
        }
        .prog-track {
            flex-grow: 1; height: 14px; background: rgba(0,0,0,0.6); 
            border: 2px solid white; border-radius: 10px; overflow: hidden;
        }
        .prog-fill { height: 100%; background: var(--gd-green); width: 0%; transition: width 0.1s; }
        .prog-text { font-size: 1.2em; -webkit-text-stroke: 1px black; width: 50px; }

        /* Contr√¥les */
        #dpad-overlay {
            position: absolute; bottom: 20px; right: 20px; width: 160px; height: 160px; pointer-events: auto; opacity: 0.5;
        }
        .dpad-row { display: flex; justify-content: center; }
        .dpad-btn {
            width: 50px; height: 50px; background: rgba(255,255,255,0.2); border: 2px solid white; margin: 2px;
            display: flex; align-items: center; justify-content: center; font-size: 1.5em; border-radius: 8px; cursor: pointer;
        }
        .dpad-btn:active { background: white; color: black; }

        #fire-btn-overlay {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); pointer-events: auto;
        }
        .fire-circle {
            width: 100px; height: 100px; background: red; border: 5px solid white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 1.5em; box-shadow: 0 0 15px red;
            cursor: pointer;
        }
        .fire-circle:active { transform: scale(0.95); background: #cc0000; }

        /* Game Over / Pause */
        .game-modal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #222; border: 5px solid white; border-radius: 20px;
            padding: 30px; text-align: center; z-index: 200; box-shadow: 0 0 50px black; width: 300px;
        }
        .btn-modal {
            display: block; padding: 12px; margin: 8px 0; border-radius: 10px; border: 3px solid white;
            cursor: pointer; font-family: 'Russo One'; color: white; width: 100%; font-size: 1.1em;
        }

    </style>
</head>
<body>

    <div class="gd-bg-layer"><div class="gd-grid-perspective"></div></div>

    <section id="screen-home" class="full-screen">
        <div class="logo-main">GAMES.IA</div>
        <div class="menu-row">
            <div class="btn-side" onclick="openShop()"><div class="icon-face"></div></div>
            <div class="btn-play-main" onclick="openLevelSelect()"></div>
            <div class="btn-side" style="background: linear-gradient(to bottom, #ffaa00, #aa5500);" onclick="openStats()">
                <div style="font-size:1em;">üèÜ</div>
            </div>
        </div>
        
        <a href="https://ko-fi.com/gamesia" target="_blank" class="btn-donate">
            <span>‚ù§Ô∏è</span> HELP US
        </a>

        <p style="margin-top:30px; opacity:0.6;">V15.1 - Final</p>
    </section>

    <section id="screen-stats" class="full-screen hidden">
        <div class="window-box">
            <button class="btn-back" onclick="goHome()">RETOUR</button>
            <h2 style="color:var(--gd-yellow)">STATS</h2>
            <div id="stats-display" style="text-align:left; margin-top:20px; line-height:1.8em; font-size:0.9em;"></div>
        </div>
    </section>

    <section id="screen-shop" class="full-screen hidden">
        <div class="window-box">
            <button class="btn-back" onclick="handleShopBack()">RETOUR</button>
            <h2 style="margin-top:25px;">SKINS</h2>
            <div class="shop-tabs">
                <div class="shop-tab active" id="tab-jumper" onclick="renderShopTab('jumper')">JUMPER</div>
                <div class="shop-tab" id="tab-sniper" onclick="renderShopTab('sniper')">SNIPER</div>
                <div class="shop-tab" id="tab-snake" onclick="renderShopTab('snake')">SNAKE</div>
            </div>
            <div id="shop-content" class="shop-grid"></div>
        </div>
    </section>

    <section id="screen-select" class="full-screen hidden">
        <div class="window-box">
            <button class="btn-back" onclick="goHome()">RETOUR</button>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:30px;">
                <div class="nav-arrow" onclick="navGame(-1)">‚ùÆ</div>
                <div style="flex:1; padding:0 20px;">
                    <div class="level-card" id="level-card">
                        <div id="lvl-title" style="font-size:1.5em; margin-bottom:10px;">TITRE</div>
                        <div id="lvl-icon" style="font-size:4em;">ICON</div>
                        <div id="lvl-desc" style="font-size:0.8em; color:#aaa; margin-top:10px;">Desc</div>
                    </div>
                </div>
                <div class="nav-arrow" onclick="navGame(1)">‚ùØ</div>
            </div>
            <button class="btn-launch" onclick="launchGame()">JOUER</button>
        </div>
    </section>

    <section id="screen-game" class="full-screen hidden">
        <canvas id="game-canvas"></canvas>

        <div id="game-hud">
            <div id="btn-pause" onclick="togglePause()">II</div>
            <div class="hud-bar">
                <div class="score-block">
                    <span id="hud-score" class="score-val">0</span>
                    <span class="score-lbl">SCORE</span>
                </div>
                <div class="prog-area">
                    <div class="prog-track"><div class="prog-fill" id="hud-prog"></div></div>
                    <div class="prog-text" id="hud-pct">0%</div>
                </div>
                <div class="score-block">
                    <span id="hud-best" class="score-val score-best">0</span>
                    <span class="score-lbl">BEST</span>
                </div>
            </div>
            <div id="sniper-msg" style="position:absolute; top:40%; left:50%; transform:translate(-50%, -50%); font-size:3em; opacity:0; pointer-events:none;">+100</div>
        </div>

        <div id="fire-btn-overlay" class="hidden">
            <div class="fire-circle" onpointerdown="inputFire()">TIR</div>
        </div>
        <div id="dpad-overlay" class="hidden">
            <div class="dpad-row"><div class="dpad-btn" onpointerdown="inputSnake(0,-1)">‚ñ≤</div></div>
            <div class="dpad-row">
                <div class="dpad-btn" onpointerdown="inputSnake(-1,0)">‚óÄ</div>
                <div class="dpad-btn" onpointerdown="inputSnake(0,1)">‚ñº</div>
                <div class="dpad-btn" onpointerdown="inputSnake(1,0)">‚ñ∂</div>
            </div>
        </div>

        <div id="modal-pause" class="game-modal hidden">
            <h2 style="color:var(--gd-yellow); margin-top:0;">PAUSE</h2>
            <button class="btn-modal" style="background:var(--gd-green); color:black;" onclick="togglePause()">REPRENDRE</button>
            <button class="btn-modal" style="background:var(--gd-blue);" onclick="openIngameShop()">CASIER</button>
            <button class="btn-modal" style="background:#555;" onclick="quitGame()">MENU</button>
        </div>

        <div id="modal-go" class="game-modal hidden" style="border-color:var(--gd-red);">
            <h2 style="color:var(--gd-red); margin-top:0;">FINI</h2>
            <div style="margin:15px 0; font-size:1.2em;">Score: <span id="go-score">0</span></div>
            <button class="btn-modal" style="background:var(--gd-green); color:black;" onclick="restartGame()">REJOUER</button>
            <button class="btn-modal" style="background:var(--gd-blue);" onclick="openIngameShop()">CASIER</button>
            <button class="btn-modal" style="background:var(--gd-yellow); color:black;" onclick="openLevelSelect()">AUTRES JEUX</button>
            <button class="btn-modal" style="background:#555;" onclick="goHome()">MENU</button>
        </div>
    </section>

    <script>
        const GAMES = [
            { id: 'jumper', title: 'STEREO JUMP', icon: 'üî∫', desc: 'Saut (Touch/Espace)', color: '#00ff00' },
            { id: 'sniper', title: 'DEADSHOT', icon: 'üéØ', desc: 'Vise le centre !', color: '#ff0000' },
            { id: 'snake', title: 'NEON SNAKE', icon: 'üêç', desc: 'Mange les pommes.', color: '#ba00e5' }
        ];
        const SKINS = {
            jumper: [ {id:'def',name:'Cube',color:'#00ff00',req:0}, {id:'gold',name:'Gold',color:'#ffd700',req:500}, {id:'fire',name:'Magma',color:'#ff4400',req:1000}, {id:'dark',name:'Ninja',color:'#222',border:'white',req:2000}, {id:'chroma',name:'Rainbow',color:'chroma',req:3000} ],
            sniper: [ {id:'def',name:'Rouge',color:'#ff0000',req:0}, {id:'blue',name:'Marine',color:'#0088ff',req:200}, {id:'swat',name:'Tactique',color:'#555',border:'white',req:500}, {id:'gold',name:'Prestige',color:'#ffd700',req:1000}, {id:'chroma',name:'Predator',color:'chroma',req:2000} ],
            snake: [ {id:'def',name:'Vert',color:'#00ff00',req:0}, {id:'cyan',name:'Cyan',color:'#00ffff',req:10}, {id:'purp',name:'Plasma',color:'#ba00e5',req:25}, {id:'gold',name:'Luxe',color:'#ffd700',req:50}, {id:'chroma',name:'Hydra',color:'chroma',req:100} ]
        };
        let saveData = { scores:{jumper:0,sniper:0,snake:0}, stats:{jumperDeath:0,sniperShots:0,sniperHits:0,snakeMaxLen:0}, skins:{jumper:'def',sniper:'def',snake:'def'} };
        if(localStorage.getItem('gamesia_v15')) try{saveData={...saveData,...JSON.parse(localStorage.getItem('gamesia_v15'))}}catch(e){}
        function save(){localStorage.setItem('gamesia_v15',JSON.stringify(saveData))}
        
        const screens={home:document.getElementById('screen-home'),stats:document.getElementById('screen-stats'),shop:document.getElementById('screen-shop'),select:document.getElementById('screen-select'),game:document.getElementById('screen-game')};
        let currentGameIndex=0, activeGameId=null, returnToGame=false;
        function showScreen(n){Object.values(screens).forEach(s=>s.classList.add('hidden'));if(n!=='game')stopGame();screens[n].classList.remove('hidden')}
        function goHome(){returnToGame=false;showScreen('home')}
        function quitGame(){returnToGame=false;showScreen('home')}
        function openStats(){
            let acc=saveData.stats.sniperShots>0?Math.round((saveData.stats.sniperHits/saveData.stats.sniperShots)*100):0;
            document.getElementById('stats-display').innerHTML=`<h3>JUMPER</h3><div>Best: <span style="color:#0f0">${Math.floor(saveData.scores.jumper)}</span></div><div>Morts: <span style="color:#f55">${saveData.stats.jumperDeath}</span></div><h3>SNIPER</h3><div>Best: <span style="color:#f00">${saveData.scores.sniper}</span></div><div>Pr√©cision: <span style="color:#0ff">${acc}%</span></div><h3>SNAKE</h3><div>Best: <span style="color:#b0e">${saveData.scores.snake}</span></div><div>Max Longueur: <span style="color:#ff0">${saveData.stats.snakeMaxLen}</span></div>`;
            showScreen('stats');
        }
        function openShop(){returnToGame=false;renderShopTab('jumper');showScreen('shop')}
        function openIngameShop(){returnToGame=true;renderShopTab(activeGameId);showScreen('shop')}
        function handleShopBack(){returnToGame&&activeGameId?showScreen('game'):goHome()}
        function renderShopTab(gid){
            document.querySelectorAll('.shop-tab').forEach(t=>t.classList.remove('active'));document.getElementById('tab-'+gid).classList.add('active');
            const c=document.getElementById('shop-content');c.innerHTML='';
            SKINS[gid].forEach(s=>{
                const u=saveData.scores[gid]>=s.req, e=saveData.skins[gid]===s.id;
                const d=document.createElement('div');d.className=`skin-card ${u?'unlocked':''} ${e?'selected':''}`;
                let bg=s.color==='chroma'?'background:linear-gradient(90deg,red,blue);animation:spin 2s linear infinite;':`background:${s.color}`;
                d.innerHTML=`<div class="skin-prev" style="${bg};border-color:${s.border||'white'}"></div><div>${s.name}</div>${!u?`<div style="color:#f55;font-size:0.8em">üîí ${s.req}</div>`:''}${e?`<div style="color:#0f0;font-size:0.8em">EQUIP√â</div>`:''}`;
                if(u)d.onclick=()=>{saveData.skins[gid]=s.id;save();renderShopTab(gid)};c.appendChild(d);
            });
        }
        function openLevelSelect(){returnToGame=false;updateCarousel();showScreen('select')}
        function navGame(d){currentGameIndex=(currentGameIndex+d+GAMES.length)%GAMES.length;updateCarousel()}
        function updateCarousel(){const g=GAMES[currentGameIndex];document.getElementById('lvl-title').innerText=g.title;document.getElementById('lvl-icon').innerText=g.icon;document.getElementById('lvl-desc').innerText=g.desc;document.getElementById('level-card').style.borderColor=g.color}
        function launchGame(){activeGameId=GAMES[currentGameIndex].id;showScreen('game');initGame()}
        
        const canvas=document.getElementById('game-canvas'), ctx=canvas.getContext('2d');
        let gameLoopId, game={running:false,paused:false};
        function resize(){canvas.width=window.innerWidth;canvas.height=window.innerHeight}
        window.addEventListener('resize',resize);
        function stopGame(){if(gameLoopId)cancelAnimationFrame(gameLoopId);game.running=false}
        function initGame(){
            resize();game.running=true;game.paused=false;
            document.getElementById('modal-go').classList.add('hidden');document.getElementById('modal-pause').classList.add('hidden');
            document.getElementById('fire-btn-overlay').classList.add('hidden');document.getElementById('dpad-overlay').classList.add('hidden');
            document.getElementById('btn-pause').classList.remove('hidden');
            document.getElementById('hud-best').innerText=Math.floor(saveData.scores[activeGameId]);
            if(activeGameId==='jumper')startJumper();else if(activeGameId==='sniper')startSniper();else startSnake();
            gameLoop();
        }
        function restartGame(){initGame()}
        function togglePause(){if(!game.running)return;game.paused=!game.paused;document.getElementById('modal-pause').classList.toggle('hidden',!game.paused)}
        function gameLoop(){
            if(!game.running)return;
            if(!game.paused){
                if(activeGameId==='jumper')updateJumper();else if(activeGameId==='sniper')updateSniper();else updateSnake();
                document.getElementById('hud-score').innerText=Math.floor(game.score);
                const b=saveData.scores[activeGameId], p=b>0?Math.floor((game.score/b)*100):0;
                document.getElementById('hud-prog').style.width=Math.min(p,100)+'%';document.getElementById('hud-pct').innerText=Math.min(p,100)+'%';
            }
            gameLoopId=requestAnimationFrame(gameLoop);
        }
        function triggerGameOver(sc){
            game.running=false;sc=Math.floor(sc);
            if(sc>saveData.scores[activeGameId])saveData.scores[activeGameId]=sc;
            if(activeGameId==='jumper')saveData.stats.jumperDeath++;
            if(activeGameId==='snake'&&game.snake.length>saveData.stats.snakeMaxLen)saveData.stats.snakeMaxLen=game.snake.length;
            save();document.getElementById('go-score').innerText=sc;
            document.getElementById('modal-go').classList.remove('hidden');document.getElementById('btn-pause').classList.add('hidden');
        }
        function getSkinColor(g){
            const s=SKINS[g].find(x=>x.id===saveData.skins[g]);
            return s.color==='chroma'?`hsl(${Date.now()/10%360},100%,50%)`:s.color;
        }

        // JUMPER
        function startJumper(){game.score=0;game.speed=6;game.p={x:50,y:0,w:40,h:40,dy:0,ground:false};game.obs=[];
            const jump=()=>{if(game.running&&!game.paused&&game.p.ground)game.p.dy=-14};
            canvas.onpointerdown=(e)=>{e.preventDefault();jump()};window.onkeydown=(e)=>{if(e.code==='Space')jump()};
        }
        function updateJumper(){
            game.score+=0.1;game.speed+=0.002;
            let p=game.p;p.dy+=0.8;p.y+=p.dy;const fy=canvas.height-100;
            if(p.y+p.h>fy){p.y=fy-p.h;p.dy=0;p.ground=true}else p.ground=false;
            if(Math.random()<0.02){const l=game.obs[game.obs.length-1];if(!l||canvas.width-l.x>300)game.obs.push({x:canvas.width,w:40,h:40})}
            ctx.fillStyle="#001133";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle="white";ctx.fillRect(0,fy,canvas.width,5);
            ctx.fillStyle=getSkinColor('jumper');ctx.fillRect(p.x,p.y,p.w,p.h);ctx.strokeStyle="white";ctx.lineWidth=3;ctx.strokeRect(p.x,p.y,p.w,p.h);
            for(let i=0;i<game.obs.length;i++){
                let o=game.obs[i];o.x-=game.speed;
                ctx.fillStyle="red";ctx.beginPath();ctx.moveTo(o.x,fy);ctx.lineTo(o.x+o.w,fy);ctx.lineTo(o.x+o.w/2,fy-o.h);ctx.fill();
                ctx.strokeStyle="white";ctx.stroke();
                if(p.x<o.x+o.w-10&&p.x+p.w>o.x+10&&p.y+p.h>fy-o.h+10)triggerGameOver(game.score);
            }
            game.obs=game.obs.filter(o=>o.x>-50);
        }

        // SNIPER
        function startSniper(){game.score=0;game.t={x:100,y:100,r:25,vx:5,vy:5};game.s={x:canvas.width/2,y:canvas.height/2,r:80};
            document.getElementById('fire-btn-overlay').classList.remove('hidden');window.onkeydown=null;canvas.onpointerdown=null;}
        function updateSniper(){
            ctx.fillStyle="#110022";ctx.fillRect(0,0,canvas.width,canvas.height);
            let t=game.t;t.x+=t.vx;t.y+=t.vy;
            if(t.x<t.r){t.x=t.r;t.vx=Math.abs(t.vx)}if(t.x>canvas.width-t.r){t.x=canvas.width-t.r;t.vx=-Math.abs(t.vx)}
            if(t.y<t.r){t.y=t.r;t.vy=Math.abs(t.vy)}if(t.y>canvas.height-t.r){t.y=canvas.height-t.r;t.vy=-Math.abs(t.vy)}
            ctx.fillStyle=getSkinColor('sniper');ctx.beginPath();ctx.arc(t.x,t.y,t.r,0,Math.PI*2);ctx.fill();ctx.strokeStyle="white";ctx.stroke();
            let s=game.s;ctx.strokeStyle="rgba(255,255,255,0.8)";ctx.lineWidth=4;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.stroke();
            ctx.beginPath();ctx.moveTo(s.x,s.y-s.r);ctx.lineTo(s.x,s.y+s.r);ctx.stroke();ctx.beginPath();ctx.moveTo(s.x-s.r,s.y);ctx.lineTo(s.x+s.r,s.y);ctx.stroke();
            ctx.fillStyle="red";ctx.beginPath();ctx.arc(s.x,s.y,4,0,Math.PI*2);ctx.fill();
        }
        function inputFire(){
            if(!game.running||game.paused)return;saveData.stats.sniperShots++;
            let t=game.t,s=game.s,d=Math.sqrt((t.x-s.x)**2+(t.y-s.y)**2),l=s.r+t.r;
            if(d<l){
                saveData.stats.sniperHits++;let p=Math.floor(100*((1-d/l)**2));if(p<1)p=1;game.score+=p;
                const m=document.getElementById('sniper-msg');m.innerText="+"+p;m.style.opacity=1;setTimeout(()=>m.style.opacity=0,500);
                t.x=Math.random()*canvas.width;t.y=Math.random()*canvas.height;
                let dx=canvas.width/2-t.x,dy=canvas.height/2-t.y,len=Math.sqrt(dx*dx+dy*dy),sp=Math.sqrt(t.vx**2+t.vy**2)*1.1;
                t.vx=(dx/len)*sp+(Math.random()-0.5)*2;t.vy=(dy/len)*sp+(Math.random()-0.5)*2;
            }else triggerGameOver(game.score);
        }

        // SNAKE
        function startSnake(){
            game.score=0;let mt=110,mx=20,cs=30,cols=Math.floor((canvas.width-mx*2)/cs),rows=Math.floor((canvas.height-mt-20)/cs);
            game.g={x:mx,y:mt,c:cs,w:cols,h:rows};game.snake=[{x:5,y:5},{x:5,y:6}];game.d={x:0,y:-1};game.nd={x:0,y:-1};game.f={x:Math.floor(cols/2),y:Math.floor(rows/2)};
            game.tm=0;game.sp=10;document.getElementById('dpad-overlay').classList.remove('hidden');
            window.onkeydown=(e)=>{if(e.key==='ArrowUp')inputSnake(0,-1);if(e.key==='ArrowDown')inputSnake(0,1);if(e.key==='ArrowLeft')inputSnake(-1,0);if(e.key==='ArrowRight')inputSnake(1,0)};
        }
        function inputSnake(x,y){if(game.d.x===-x&&x!==0)return;if(game.d.y===-y&&y!==0)return;game.nd={x:x,y:y}}
        function updateSnake(){
            ctx.fillStyle="#111";ctx.fillRect(0,0,canvas.width,canvas.height);let g=game.g;
            ctx.strokeStyle="#444";ctx.lineWidth=2;ctx.strokeRect(g.x,g.y,g.w*g.c,g.h*g.c);
            ctx.strokeStyle="#222";ctx.lineWidth=1;
            for(let i=0;i<=g.w;i++){ctx.beginPath();ctx.moveTo(g.x+i*g.c,g.y);ctx.lineTo(g.x+i*g.c,g.y+g.h*g.c);ctx.stroke()}
            for(let i=0;i<=g.h;i++){ctx.beginPath();ctx.moveTo(g.x,g.y+i*g.c);ctx.lineTo(g.x+g.w*g.c,g.y+i*g.c);ctx.stroke()}
            let f=game.f;ctx.fillStyle="#f33";ctx.beginPath();ctx.arc(g.x+f.x*g.c+g.c/2,g.y+f.y*g.c+g.c/2,g.c/2-4,0,Math.PI*2);ctx.fill();
            ctx.fillStyle=getSkinColor('snake');game.snake.forEach(s=>{ctx.fillRect(g.x+s.x*g.c+1,g.y+s.y*g.c+1,g.c-2,g.c-2)});
            game.tm++;if(game.tm>game.sp){
                game.tm=0;game.d=game.nd;let h={x:game.snake[0].x+game.d.x,y:game.snake[0].y+game.d.y};
                if(h.x<0||h.x>=g.w||h.y<0||h.y>=g.h||game.snake.some(s=>s.x===h.x&&s.y===h.y)){triggerGameOver(game.score);return}
                game.snake.unshift(h);
                if(h.x===game.f.x&&h.y===game.f.y){
                    game.score++;if(game.score%2===0&&game.sp>4)game.sp--;
                    let v=false;while(!v){game.f={x:Math.floor(Math.random()*g.w),y:Math.floor(Math.random()*g.h)};v=!game.snake.some(s=>s.x===game.f.x&&s.y===game.f.y)}
                }else game.snake.pop();
            }
        }
    </script>
</body>
</html>
